@* Views/Shared/_Layout.cshtml *@ @ {
    var ctrl = ViewContext.RouteData.Values["controller"]?.ToString();
    var pathWithQuery = (Context?.Request?.Path + Context?.Request?.QueryString).ToString();
}

<!DOCTYPE html >
<html lang="es" >
<head >
<meta charset="UTF-8" >
<meta name="viewport" content="width=device-width, initial-scale=1" / >
<title > @(ViewData["Title"] ?? "AnalisisPredictivoVentas")</title >
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" >
<!-- Estilos propios -->
<style >
body {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

.content-wrapper {
    flex: 1;
    display: flex;
    min-height: 0;
}

.sidebar {
    width: 260px;
    background-color: #343a40;
    color: #fff;
    padding: 1rem;
    min-height: 100%;
}

    .sidebar .brand {
        color: #fff;
        text-decoration: none;
        font-weight: 600;
        display: inline-block;
        margin-bottom: .75rem;
    }

    .sidebar .menu-title {
        color: #ced4da;
        font-size: .9rem;
        letter-spacing: .04em;
        text-transform: uppercase;
        margin: .75rem 0 .5rem;
    }

    .sidebar a {
        color: #adb5bd;
        text-decoration: none;
        display: block;
        padding: .5rem .25rem;
        border-radius: .375rem;
    }

        .sidebar a:hover {
            color: #fff;
            background-color: rgba(255,255,255,.08);
        }

        .sidebar a.active {
            color: #fff;
            background-color: rgba(13,110,253,.25);
        }

.main-content {
    flex: 1;
    padding: 2rem;
    background-color: #f8f9fa;
    overflow: auto;
}

footer {
    background: #212529;
    color: #adb5bd;
    text-align: center;
    padding: 1rem 0;
}
/* Responsive: sidebar arriba en móviles */
@media (max-width: 991.98px) {
    .content-wrapper {
        flex-direction: column;
    }

    .sidebar {
        width: 100%;
        min-height: auto;
        border-bottom: 1px solid rgba(255,255,255,.1);
    }
}

/* HERO estable: sin solapes */
.hero-ventas {
    position: relative;
    height: 340px; /* <- Altura fija evita montajes */
    background-image: url("/img/ventas-hero.jpg");
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    overflow: hidden;
}

    .hero-ventas .hero-overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(90deg, rgba(0,0,0,.55), rgba(0,0,0,.25));
    }

    .hero-ventas .hero-content {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center; /* centra vertical */
    }

/* Detalles visuales */
.card {
    border: 0;
    border-radius: 1rem;
}

</style >

<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" / >
@RenderSection("Styles", required: false)
</head >
<body >
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark" >
<div class="container-fluid" >
<a class="navbar-brand fw-bold" asp-controller="Home" asp-action="Index" > AnalisisPredictivoVentas</a >
<button class="navbar-toggler" type="button" data-bs-toggle="collapse"
data-bs-target="#topbar" aria-controls="topbar" aria-expanded="false" aria-label="Alternar navegación" >
<span class="navbar-toggler-icon" > </span >
</button >

<div id="topbar" class="collapse navbar-collapse justify-content-end" >
<ul class="navbar-nav mb-2 mb-lg-0" >
@if (User.Identity?.IsAuthenticated ?? false) {
    <li class="nav-item dropdown"> <a class="nav-link dropdown-toggle" href="#" id="userMenu" role="button" data-bs-toggle="dropdown" aria-expanded="false"> @User.Identity !.Name </a> <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenu"> <li><a class="dropdown-item" asp-controller="Home" asp-action="Index">Inicio</a></li> <li><hr class="dropdown-divider" /></li> <li> <form asp-controller="Account" asp-action="Logout" method="post" class="px-3 py-1"> <button type="submit" class="btn btn-sm btn-outline-danger w-100">Cerrar sesión</button> </form> </li> </ul> </li>
}

else {
    <li class="nav-item"> <a class="nav-link" asp-controller="Account" asp-action="Login" asp-route-returnUrl="@pathWithQuery">Iniciar sesión</a> </li>
}

</ul >
</div >
</div >
</nav >
<!-- Content Wrapper -->
<div class="content-wrapper" >
<!-- Sidebar -->
<aside class="sidebar" >
<a class="brand" asp-controller="Home" asp-action="Index" > MiApp</a >

<div class="menu-title" > Menú</div >
<a class="@(ctrl=="Home" ? "active" : null)"
asp-controller="Home" asp-action="Index" > 🏠 Inicio</a >

<a class="@(ctrl=="Dashboard" ? "active" : null)"
asp-controller="Dashboard" asp-action="Index" > 📊 Dashboard</a >

@* Cargas: Admin o ResponsableCarga *@
@if (User.IsInRole("Administrador") || User.IsInRole("ResponsableCarga")) {
    <a class="@(ctrl=="Uploads" ? "active" : null)" asp-controller="Uploads" asp-action="Index">☁️ Cargas</a>
}

@* Usuarios / Configuración: solo Admin *@ @if (User.IsInRole("Administrador")) {
    <a class="@(ctrl=="Usuarios" ? "active" : null)" asp-controller="Usuarios" asp-action="Index">👥 Usuarios</a> <a class="@(ctrl=="Configuraciones" ? "active" : null)" asp-controller="Configuraciones" asp-action="Index">⚙️ Configuración</a>
}

<hr / >

@if (User.Identity?.IsAuthenticated ?? false) {
    <form asp-controller="Account" asp-action="Logout" method="post"> <button type="submit" class="btn btn-sm btn-outline-light w-100">🚪 Cerrar sesión</button> </form>
}

else {
    <a class="" asp-controller="Account" asp-action="Login" asp-route-returnUrl="@pathWithQuery">🔑 Iniciar sesión</a>
}

</aside >
<!-- Main Content -->
<main class="main-content" >
@* Alertas por TempData opcionales *@
@if (TempData["Success"] is string ok && !string.IsNullOrWhiteSpace(ok)) {
    <div class="alert alert-success alert-dismissible fade show" role="alert"> @ok <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button> </div>
}

@if (TempData["Error"] is string err && !string.IsNullOrWhiteSpace(err)) {
    <div class="alert alert-danger alert-dismissible fade show" role="alert"> @err <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button> </div>
}

@RenderSection("PageHeader", required: false) @RenderBody() </main> </div>
<!-- Footer -->
<footer> <p class="mb-0">&copy;
@DateTime.Now.Year AnalisisPredictivoVentas · Todos los derechos reservados</p> </footer>
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script> @RenderSection("Modals", required: false) @RenderSection("Scripts", required: false) </body> </html>

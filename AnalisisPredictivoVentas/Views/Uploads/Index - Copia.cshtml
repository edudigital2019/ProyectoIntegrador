@{
    ViewData["Title"] = "Cargar Ventas (JSON/XML/CSV)";
}
<div class="container mt-4">
    <h2>Cargar archivo de Ventas</h2>
    @if (TempData["Err"] is string err)
    {
        <div class="alert alert-danger">@err</div>
    }
    <form asp-action="Index" method="post" enctype="multipart/form-data" class="mt-3">
        <div class="mb-3">
            <label class="form-label">Archivo (.json / .xml / .csv)</label>
            <input class="form-control" type="file" name="archivo" accept=".json,.xml,.csv" required />
            <div class="form-text">El archivo puede contener una o varias ventas.</div>
        </div>
        <button class="btn btn-primary">Subir y procesar</button>
        @Html.AntiForgeryToken()
    </form>

    <hr />
    <h5>Ejemplo JSON</h5>
    <pre class="bg-light p-2 small">
{
  "ArchivoId": "LOTE-001",
  "Almacen": { "Codigo": "ALM01", "Nombre": "Principal" },
  "Ventas": [
    {
      "Numero": "V-1001",
      "Fecha": "2025-08-31T10:32:00",
      "Cliente": { "Identificacion": "0912345678", "Nombre": "Juan Perez" },
      "Detalles": [
        { "Producto": { "Codigo": "P001", "Nombre": "Zapatilla A", "Categoria": "Calzado" }, "Cantidad": 2, "PrecioUnitario": 25, "Descuento": 0, "Subtotal": 50 },
        { "Producto": { "Codigo": "P002", "Nombre": "Zapatilla B" }, "Cantidad": 1, "PrecioUnitario": 30, "Descuento": 5, "Subtotal": 25 }
      ],
      "Pagos": [ { "Metodo": "Efectivo", "Monto": 75 } ]
    }
  ]
}
  </pre>

    <h5>Ejemplo XML</h5>
    <pre class="bg-light p-2 small">
&lt;ArchivoVentas&gt;
  &lt;Almacen&gt;&lt;Codigo&gt;ALM01&lt;/Codigo&gt;&lt;Nombre&gt;Principal&lt;/Nombre&gt;&lt;/Almacen&gt;
  &lt;Ventas&gt;
    &lt;Venta&gt;
      &lt;Numero&gt;V-1001&lt;/Numero&gt;
      &lt;Fecha&gt;2025-08-31T10:32:00&lt;/Fecha&gt;
      &lt;Cliente&gt;&lt;Identificacion&gt;0912345678&lt;/Identificacion&gt;&lt;Nombre&gt;Juan Perez&lt;/Nombre&gt;&lt;/Cliente&gt;
      &lt;Detalles&gt;
        &lt;Detalle&gt;
          &lt;Producto&gt;&lt;Codigo&gt;P001&lt;/Codigo&gt;&lt;Nombre&gt;Zapatilla A&lt;/Nombre&gt;&lt;Categoria&gt;Calzado&lt;/Categoria&gt;&lt;/Producto&gt;
          &lt;Cantidad&gt;2&lt;/Cantidad&gt;&lt;PrecioUnitario&gt;25&lt;/PrecioUnitario&gt;&lt;Descuento&gt;0&lt;/Descuento&gt;&lt;Subtotal&gt;50&lt;/Subtotal&gt;
        &lt;Detalle&gt;
      &lt;/Detalles&gt;
      &lt;Pagos&gt;&lt;Pago&gt;&lt;Metodo&gt;Efectivo&lt;/Metodo&gt;&lt;Monto&gt;50&lt;/Monto&gt;&lt;/Pago&gt;&lt;/Pagos&gt;
    &lt;/Venta&gt;
  &lt;/Ventas&gt;
&lt;/ArchivoVentas&gt;
  </pre>

    <h5>Ejemplo CSV (una fila = un detalle)</h5>
    <pre class="bg-light p-2 small">
Numero,Fecha,AlmacenCodigo,AlmacenNombre,ClienteIdentificacion,ClienteNombre,EmpleadoUsuarioId,EmpleadoNombre,ProductoCodigo,ProductoNombre,Categoria,Cantidad,PrecioUnitario,Descuento,Subtotal,Pagos
V-1001,2025-08-31T10:32:00,ALM01,Principal,0912345678,Juan Perez,u-123,María Lopez,P001,Zapatilla A,Calzado,2,25,0,50,"Efectivo:50|Tarjeta:25"
V-1001,2025-08-31T10:32:00,ALM01,Principal,0912345678,Juan Perez,u-123,María Lopez,P002,Zapatilla B,Calzado,1,30,5,25,"Efectivo:50|Tarjeta:25"
  </pre>
    <div class="small text-muted">Delimitador soportado: coma o punto y coma. En la columna <code>Pagos</code> usa <code>Metodo:Monto</code> separados por <code>|</code>. Si no usas Pagos, coloca columnas <code>MetodoPago</code> y <code>MontoPago</code> (una forma alternativa).</div>
</div>
